webpackJsonp([12],{"1e3o":function(t,e,r){"use strict";var n=r("Xxa5"),a=r.n(n),i=r("woOf"),s=r.n(i),u=r("exGp"),o=r.n(u),l=r("Jwcj");e.a={layout:"admin",middleware:"auth",methods:{clickTag:function(t){this.tags=l.a.remove(this.tags,t),this.form.tags.push(t)},onSubmit:function(t){var e=this;this.$refs[t].validate(function(){var t=o()(a.a.mark(function t(r){var n,i;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!r){t.next=16;break}if(n=e.$store.state.user.id,i=void 0,!e.$route.query.id){t.next=10;break}return e.form.id=e.$route.query.id,delete e.form.user,t.next=7,e.$store.dispatch("article/PATCH_ARTICLE",e.form);case 7:i=t.sent,t.next=13;break;case 10:return t.next=12,e.$store.dispatch("article/POST_ARTICLE",s()(e.form,{user:n}));case 12:i=t.sent;case 13:i.success?(e.$message({message:"提交成功",type:"success"}),e.$router.push("/admin/articles")):e.$message.error(i.message),t.next=18;break;case 16:return e.$message.error("提交失败"),t.abrupt("return",!1);case 18:case"end":return t.stop()}},t,e)}));return function(e){return t.apply(this,arguments)}}())},onCancel:function(){this.$router.push("/admin/articles")},handleAvatarSuccess:function(t,e){this.form.thumb=t.data.url},handleAvatarError:function(t){console.log(t)},beforeAvatarUpload:function(t){var e="image/jpg"===t.type,r="image/jpeg"===t.type,n="image/png"===t.type,a=t.size/1024/1024<2,i=!1;return e||r||n?i=!0:this.$message.error("缩略图只能是 JPG或PNG 格式!"),a||this.$message.error("缩略图片大小不能超过 2MB!"),i&&a},handleClose:function(t){this.form.tags.splice(this.form.tags.indexOf(t),1),this.tags.push(t)},showInput:function(){var t=this;this.tagInputVisible=!0,this.$nextTick(function(e){t.$refs.saveTagInput.$refs.input.focus()})},handleInputConfirm:function(){var t=this.tagInputValue;t&&this.form.tags.push(t),this.tagInputVisible=!1,this.tagInputValue=""}},data:function(){return{tagInputVisible:!1,tagInputValue:"",editorOption:{theme:"snow"},form:{type:"",title:"",desc:"",thumb:"",content:"",tags:[]},rules:{type:[{required:!0,message:"请选择类型",trigger:"blur"}],title:[{required:!0,message:"请输入标题",trigger:"blur"}],desc:[{required:!0,message:"请输入描述",trigger:"blur"}],thumb:[{required:!0,message:"请上传缩略图",trigger:"blur"}],content:[{required:!0,message:"请输入内容",trigger:"blur"}],tags:[{required:!0,message:"请输入标签",trigger:"blur"}]},options:["期刊","日志"],tags:[]}},created:function(){var t=o()(a.a.mark(function t(){var e=this;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$store.dispatch("tag/GET_TAGS");case 2:t.sent.data.forEach(function(t){e.tags.push(t.name)});case 4:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),mounted:function(){var t=o()(a.a.mark(function t(){var e,r;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.$route.query.id){t.next=8;break}return t.next=3,this.$store.dispatch("article/GET_ARTICLE",this.$route.query.id);case 3:e=t.sent,r=e.data.tags,e.data.tags=[],r.forEach(function(t){e.data.tags.push(t.name)}),s()(this.form,e.data);case 8:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()}},Jwcj:function(t,e,r){"use strict";var n=r("lHA8"),a=r.n(n),i=r("c/Tr"),s=r.n(i),u={contains:function(t,e){return-1!=t.indexOf(e)},remove:function(t,e){var r=t.indexOf(e);return r>-1&&t.splice(r,1),t},each:function(t,e){e=e||Function;for(var r=[],n=Array.prototype.slice.call(arguments,1),a=0;a<t.length;a++){var i=e.apply(t,[t[a],a].concat(n));null!=i&&r.push(i)}},map:function(t,e,r){for(var n=r||window,a=[],i=0,s=t.length;i<s;++i){var u=e.call(n,t[i],i,this);null!=u&&a.push(u)}return a},sort:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t.sort(function(r,n){switch(e){case 1:return r-n;case 2:return n-r;case 3:return Math.random()-.5;default:return t}})},unique:function(t){if(Array.hasOwnProperty("from"))return s()(new a.a(t));for(var e={},r=[],n=0;n<t.length;n++)e[t[n]]||(e[t[n]]=!0,r.push(t[n]));return r},union:function(t,e){var r=t.concat(e);return this.unique(r)},intersect:function(t,e){var r=this;return t=this.unique(t),this.map(t,function(t){return r.contains(e,t)?t:null})},complement:function(t,e){return this.minus(this.union(t,e),this.intersect(t,e))},minus:function(t,e){return t=this.unique(t),this.map(t,function(t){return e.includes(t)?null:t})},formArray:function(t){return Array.isArray(t)?t:Array.prototype.slice.call(t)},max:function(t){return Math.max.apply(null,t)},min:function(t){return Math.min.apply(null,t)},sum:function(t){return t.reduce(function(t,e){return t+e})},average:function(t){return this.sum(t)/t.length},isRepeat:function(t){var e={};for(var r in t){if(e[t[r]])return!0;e[t[r]]=!0}return!1},getItemByRandom:function(t){return t[Math.floor(Math.random()*t.length)]},getIndexByItem:function(t,e){for(var r=0;r<t.length;r++)if(t[r]==e)return r;return-1},getItemByIndex:function(t,e){return t[e]},setItemByIndex:function(t,e,r){return t[e]=r,t},removeByItem:function(t,e){var r=this.unique(t),n=this.getIndexByItem(r,e);return n>-1&&r.splice(n,1),r},removeByIndex:function(t,e){return t.splice(e,1),t}};e.a=u},Q4sO:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r("1e3o"),a=r("aYRk"),i=r("VU/8")(n.a,a.a,!1,null,null,null);i.options.__file="pages/admin/articles/editor.vue",e.default=i.exports},aYRk:function(t,e,r){"use strict";var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"admin-editor"},[r("el-form",{ref:"form",attrs:{rules:t.rules,model:t.form,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"类型",prop:"type"}},[r("el-select",{attrs:{placeholder:"请选择"},model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},t._l(t.options,function(t){return r("el-option",{key:t,attrs:{label:t,value:t}})}),1)],1),r("el-form-item",{attrs:{label:"标题",prop:"title"}},[r("el-input",{model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),"期刊"===t.form.type?r("el-form-item",{attrs:{label:"描述",prop:"desc"}},[r("el-input",{attrs:{type:"textarea"},model:{value:t.form.desc,callback:function(e){t.$set(t.form,"desc",e)},expression:"form.desc"}})],1):t._e(),"期刊"===t.form.type?r("el-form-item",{attrs:{label:"缩略图",prop:"thumb"}},[r("el-upload",{staticClass:"avatar-uploader",attrs:{action:"/upload/thumb","show-file-list":!1,"on-success":t.handleAvatarSuccess,"on-error":t.handleAvatarError,"before-upload":t.beforeAvatarUpload}},[t.form.thumb?r("img",{staticClass:"avatar",attrs:{src:t.form.thumb}}):r("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1):t._e(),r("el-form-item",{attrs:{label:"内容",prop:"content"}},[r("div",{directives:[{name:"quill",rawName:"v-quill:myQuillEditor",value:t.editorOption,expression:"editorOption",arg:"myQuillEditor"}],staticClass:"quill-editor",model:{value:t.form.content,callback:function(e){t.$set(t.form,"content",e)},expression:"form.content"}})]),r("el-form-item",{attrs:{label:"标签",prop:"tags"}},[t._l(t.form.tags,function(e){return r("el-tag",{key:e,attrs:{closable:"","disable-transitions":!1},on:{close:function(r){t.handleClose(e)}}},[t._v("\n        "+t._s(e)+"\n      ")])}),t.tagInputVisible?r("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{size:"small"},on:{blur:t.handleInputConfirm},nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.handleInputConfirm(e):null}},model:{value:t.tagInputValue,callback:function(e){t.tagInputValue=e},expression:"tagInputValue"}}):r("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:t.showInput}},[t._v("+ 标签")])],2),r("el-form-item",{attrs:{label:"常用标签"}},t._l(t.tags,function(e){return r("el-tag",{key:e,attrs:{"disable-transitions":!1},nativeOn:{click:function(r){t.clickTag(e)}}},[t._v("\n        "+t._s(e)+"\n      ")])}),1),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(e){t.onSubmit("form")}}},[t._v("立即提交")]),r("el-button",{on:{click:t.onCancel}},[t._v("取消")])],1)],1)],1)};n._withStripped=!0;var a={render:n,staticRenderFns:[]};e.a=a}});