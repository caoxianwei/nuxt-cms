webpackJsonp([6],{"/nBF":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("552V"),r=n("4oXN"),s=n("VU/8")(i.a,r.a,!1,null,null,null);s.options.__file="pages/detail/article/_id.vue",e.default=s.exports},"4oXN":function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"article-detail"},[n("div",{staticClass:"grid-container"},[n("div",{staticClass:"ql-container ql-snow"},[n("div",{staticClass:"ql-editor"},[n("div",{staticClass:"title"},[t._v(t._s(t.detail.title))]),n("div",{staticClass:"info"},[t._v(t._s(t.detail.user.name)+" 发布于 "+t._s(t._f("formatDate")(t.detail.createdAt)))]),n("hr"),n("div",{domProps:{innerHTML:t._s(t.detail.content)}})])]),n("hr"),n("div",{staticClass:"flex-center-sb nav-article"},[t.detail.pre.id?n("div",{staticClass:"pre",on:{click:function(e){t.go(t.detail.pre.id)}}},[t._v("上一篇："),n("span",[t._v(t._s(t.detail.pre.title))])]):n("div",[t._v("上一篇：无")]),t.detail.next.id?n("div",{staticClass:"next",on:{click:function(e){t.go(t.detail.next.id)}}},[t._v("下一篇："),n("span",[t._v(t._s(t.detail.next.title))])]):n("div",{staticClass:"next"},[t._v("下一篇：无")])]),n("hr"),n("div",{staticClass:"like-wrapper"},[n("div",[n("i",{staticClass:"star",class:t.like?"el-icon-star-on":"el-icon-star-off",on:{click:t.toggleLike}})]),n("div",{staticClass:"text"},[t._v("Like it? "),n("span",[t._v("Total "),n("i",[t._v(t._s(t.likes.total))]),t._v(" likes this article! Total "),n("i",[t._v(t._s(t.detail.view))]),t._v(" views!")])]),n("ul",{staticClass:"liker-wrapper"},t._l(t.likerAvatars,function(t){return n("li",[n("img",{attrs:{src:t}})])}),0)]),n("el-input",{attrs:{placeholder:"评论内容..."},nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.submit(e):null}},model:{value:t.commit,callback:function(e){t.commit=e},expression:"commit"}},[n("el-button",{attrs:{slot:"append"},on:{click:t.submit},slot:"append"},[t._v("提交评论")])],1),n("hr"),n("div",{staticClass:"comment-wrapper"},[n("ul",t._l(t.comments,function(e){return n("li",{on:{click:function(n){t.reply(e)}}},[n("div",{staticClass:"who flex-row-sb"},[e.reply?n("div",{staticClass:"avatar"},[n("img",{attrs:{src:e.user.avatar}}),n("span",[t._v(t._s(e.user.name))]),t._v(" 回复 "),n("span",[t._v(t._s(e.reply.name))]),t._v(" :")]):n("div",{staticClass:"avatar"},[n("img",{attrs:{src:e.user.avatar}}),n("span",[t._v(t._s(e.user.name))])]),n("div",{staticClass:"date"},[t._v(t._s(t._f("formatDate")(e.createdAt)))])]),n("div",{staticClass:"comment"},[t._v(t._s(e.content))])])}),0),n("div",{directives:[{name:"show",rawName:"v-show",value:t.onLoading,expression:"onLoading"}],staticClass:"load-more"},[t._v("加载中...")]),n("div",{directives:[{name:"show",rawName:"v-show",value:t.noMore,expression:"noMore"}],staticClass:"load-more"},[t._v("没有更多数据了")])])],1),n("div",{staticStyle:{height:"100px"}}),n("div",{staticClass:"fixed-window fixed-bc"},[n("div",{on:{click:t.backHome}},[n("i",{staticClass:"el-icon-menu"})]),n("div",{on:{click:t.backTop}},[n("i",{staticClass:"el-icon-upload2"})])])])};i._withStripped=!0;var r={render:i,staticRenderFns:[]};e.a=r},"552V":function(t,e,n){"use strict";var i=n("//Fk"),r=n.n(i),s=n("d7EF"),a=n.n(s),o=n("Xxa5"),c=n.n(o),u=n("exGp"),l=n.n(u),d=n("FMSy"),f=n("KdxW"),p=n("ndao");e.a={mixins:[p.a],head:function(){return{title:this.detail.title+" - NUXT CMS"}},methods:{go:function(t){this.$router.push("/detail/article/"+t)},backHome:function(){this.$router.push("/")},backTop:function(){d.a.backToTop()},loadMore:function(){var t=l()(c.a.mark(function t(){var e;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.noMore){t.next=14;break}return this.onLoading=!0,this.pageIndex++,t.next=5,this.$store.dispatch("comment/GET_COMMENTS","?article="+this.detail._id+"&pageIndex="+this.pageIndex+"&pageSize="+this.pageSize);case 5:if(e=t.sent,this.onLoading=!1,!f.a.isEmpty(e.data)){t.next=11;break}this.noMore=!0,t.next=14;break;case 11:return this.comments=this.comments.concat(e.data),t.next=14,this.$store.commit("comment/SET_COMMENTS",this.comments);case 14:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),reloadComments:function(){var t=l()(c.a.mark(function t(){var e;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.pageIndex=1,this.noMore=!1,this.comments=[],t.next=5,this.$store.dispatch("comment/GET_COMMENTS","?article="+this.detail._id+"&pageIndex="+this.pageIndex+"&pageSize="+this.pageSize);case 5:e=t.sent,this.comments=e.data,this.$store.commit("comment/SET_COMMENTS",this.comments);case 8:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),reply:function(){var t=l()(c.a.mark(function t(e){var n=this;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,this.$store.state.user.id){t.next=3;break}throw"请先登录";case 3:this.$prompt("","",{confirmButtonText:"回复",cancelButtonText:"取消",inputPlaceholder:"回复内容",inputPattern:/./,inputErrorMessage:"请输入内容"}).then(function(){var t=l()(c.a.mark(function t(i){var r,s=i.value;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r={content:s,user:n.$store.state.user.id,reply:e.user.id,article:e.article.id},t.next=3,n.$store.dispatch("comment/POST_COMMENT",r);case 3:t.sent.success&&n.reloadComments();case 5:case"end":return t.stop()}},t,n)}));return function(e){return t.apply(this,arguments)}}()).catch(function(){console.log("取消输入")}),t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),this.$message({showClose:!0,message:t.t0,type:"error"});case 9:case"end":return t.stop()}},t,this,[[0,6]])}));return function(e){return t.apply(this,arguments)}}(),toggleLike:function(){var t=l()(c.a.mark(function t(){var e,n,i,r,s,a=this;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,this.$store.state.user.id){t.next=3;break}throw"请先登录";case 3:if(this.like=!this.like,e={user:this.$store.state.user.id,article:this.detail._id},!this.like){t.next=23;break}return this.likes.total++,t.next=9,this.$store.dispatch("like/POST_LIKE",e);case 9:return n=t.sent,this.likeId=n.data.id,t.next=13,this.$store.dispatch("like/GET_LIKES","?article="+this.detail._id);case 13:if(i=t.sent,this.likerAvatars=[],i.data.forEach(function(t){a.likerAvatars.push(t.user.avatar)}),!n.success||!i.success){t.next=20;break}this.$message({showClose:!0,message:"点赞成功",type:"success"}),t.next=21;break;case 20:throw n.message;case 21:t.next=37;break;case 23:return this.likes.total--,t.next=26,this.$store.dispatch("like/DEL_LIKE",this.likeId);case 26:return r=t.sent,t.next=29,this.$store.dispatch("like/GET_LIKES","?article="+this.detail._id);case 29:if(s=t.sent,this.likerAvatars=[],s.data.forEach(function(t){a.likerAvatars.push(t.user.avatar)}),!r.success||!s.success){t.next=36;break}this.$message({showClose:!0,message:"取消点赞成功",type:"success"}),t.next=37;break;case 36:throw r.message;case 37:t.next=42;break;case 39:t.prev=39,t.t0=t.catch(0),this.$message({showClose:!0,message:t.t0,type:"error"});case 42:case"end":return t.stop()}},t,this,[[0,39]])}));return function(){return t.apply(this,arguments)}}(),submit:function(){var t=l()(c.a.mark(function t(){var e;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,this.$store.state.user.id){t.next=3;break}throw"请先登录";case 3:if(this.commit){t.next=5;break}throw"请填写评论内容";case 5:return e={content:this.commit,user:this.$store.state.user.id,article:this.detail._id},t.next=8,this.$store.dispatch("comment/POST_COMMENT",e);case 8:t.sent.success&&this.reloadComments(),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),this.$message({showClose:!0,message:t.t0,type:"error"});case 15:case"end":return t.stop()}},t,this,[[0,12]])}));return function(){return t.apply(this,arguments)}}()},asyncData:function(){var t=l()(c.a.mark(function t(e){var n,i,s,o,u,l,d=e.store,f=e.params;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.a.all([d.dispatch("article/GET_ARTICLE",f.id),d.dispatch("like/GET_LIKES","?article="+f.id+"&user="+d.state.user.id),d.dispatch("like/GET_LIKES","?article="+f.id+"&pageSize=50")]);case 2:return n=t.sent,i=a()(n,3),s=i[0],o=i[1],u=i[2],l=[],u.total>0&&u.data.forEach(function(t){l.push(t.user.avatar)}),t.abrupt("return",{detail:s.data,like:o.total>0,likeId:o.total>0?o.data[0].id:null,likes:u,likerAvatars:l});case 10:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),created:function(){var t=l()(c.a.mark(function t(){var e;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$store.dispatch("comment/GET_COMMENTS","?article="+this.detail._id+"&pageIndex=1&pageSize="+this.pageSize);case 2:return e=t.sent,this.comments=e.data,t.next=6,this.$store.commit("comment/SET_COMMENTS",this.comments);case 6:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),data:function(){return{commit:"",comments:[],pageIndex:1,pageSize:10,onLoading:!1,noMore:!1}}}},"5PlU":function(t,e,n){var i=n("RY/4"),r=n("dSzd")("iterator"),s=n("/bQp");t.exports=n("FeBl").isIterable=function(t){var e=Object(t);return void 0!==e[r]||"@@iterator"in e||s.hasOwnProperty(i(e))}},FMSy:function(t,e,n){"use strict";var i={hashToTop:function(t){location.hash="",location.hash=t},backToTop:function(){document.documentElement.scrollTop=0,document.body.scrollTop=0}};e.a=i},KdxW:function(t,e,n){"use strict";var i=n("mvHQ"),r=n.n(i),s={isBrowser:function(){var t=navigator.userAgent,e=t.indexOf("Opera")>-1,n=t.indexOf("compatible")>-1&&t.indexOf("MSIE")>-1&&!e,i=t.indexOf("Trident")>-1&&t.indexOf("rv:11.0")>-1,r=t.indexOf("Edge")>-1&&!n,s=t.indexOf("Firefox")>-1,a=t.indexOf("Safari")>-1&&-1==t.indexOf("Chrome"),o=t.indexOf("Chrome")>-1&&t.indexOf("Safari")>-1;return n?(new RegExp("MSIE (\\d+\\.\\d+);").test(t),{name:"IE",version:parseFloat(RegExp.$1)}):i?{name:"IE11",version:11}:r?{name:"Edge",version:0}:s?{name:"Firefox",version:0}:e?{name:"Opera",version:0}:a?{name:"Safari",version:0}:o?{name:"Chrome",version:0}:void 0},isString:function(t){return"String"===Object.prototype.toString.call(t).slice(8,-1)},isNumber:function(t){return"Number"===Object.prototype.toString.call(t).slice(8,-1)},isBoolean:function(t){return"Boolean"===Object.prototype.toString.call(t).slice(8,-1)},isFunction:function(t){return"Function"===Object.prototype.toString.call(t).slice(8,-1)},isNull:function(t){return"Null"===Object.prototype.toString.call(t).slice(8,-1)},isUndefined:function(t){return"Undefined"===Object.prototype.toString.call(t).slice(8,-1)},isObj:function(t){return"Object"===Object.prototype.toString.call(t).slice(8,-1)},isArray:function(t){return"Array"===Object.prototype.toString.call(t).slice(8,-1)},isDate:function(t){return"Date"===Object.prototype.toString.call(t).slice(8,-1)},isError:function(t){return"Error"===Object.prototype.toString.call(t).slice(8,-1)},isSymbol:function(t){return"Symbol"===Object.prototype.toString.call(t).slice(8,-1)},isPromise:function(t){return"Promise"===Object.prototype.toString.call(t).slice(8,-1)},isSet:function(t){return"Set"===Object.prototype.toString.call(t).slice(8,-1)},isEmpty:function(t){return"{}"===r()(t)||"[]"===r()(t)},isFalse:function(t){return!t||"null"===t||"undefined"===t||"false"===t||"NaN"===t},isInt:function(t){return/^-?\d+$/.test(t)},isPhone:function(t){return/^1[3|4|5|6|7|8|9][0-9]{9}$/.test(t)},isTel:function(t){return/^(0\d{2,3}-\d{7,8})(-\d{1,4})?$/.test(t)},isUser:function(t){return/^[a-zA-Z]\w{1,17}$/.test(t)},isPassword:function(t){return/^[a-zA-Z]\w{5,17}$/.test(t)},isPostal:function(t){return/[1-9]\d{5}(?!\d)/.test(t)},isQQ:function(t){return/^[1-9][0-9]{4,9}$/.test(t)},isEmail:function(t){return/^[\w-]+(\.[\w-]+)*@[\w-]+(\.[\w-]+)+$/.test(t)},isMoney:function(t){return/^\d*(?:\.\d{0,2})?$/.test(t)},isURL:function(t){return/(http|ftp|https):\/\/[\w\-_]+(\.[\w\-_]+)+([\w\-\.,@?^=%&:/~\+#]*[\w\-\@?^=%&/~\+#])?/.test(t)},isIP:function(t){return/((?:(?:25[0-5]|2[0-4]\\d|[01]?\\d?\\d)\\.){3}(?:25[0-5]|2[0-4]\\d|[01]?\\d?\\d))/.test(t)},isEnglish:function(t){return/^[a-zA-Z]+$/.test(t)},isChinese:function(t){return/^[\u4E00-\u9FA5]+$/.test(t)},isLower:function(t){return/^[a-z]+$/.test(t)},isUpper:function(t){return/^[A-Z]+$/.test(t)},isHTML:function(t){return/<("[^"]*"|'[^']*'|[^'">])*>/.test(t)},isSpace:function(t){return/\s/.test(t)},isIdCard:function(t){return/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/.test(t)},isBankCard:function(t){return/^\d{16}|\d{19}$/.test(t)},isIos:function(){var t=navigator.userAgent;return!(t.indexOf("Android")>-1||t.indexOf("Linux")>-1)&&(t.indexOf("iPhone")>-1||!(t.indexOf("iPad")>-1)&&(t.indexOf("Windows Phone"),!1))},isPC:function(){for(var t=navigator.userAgent,e=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],n=!0,i=0;i<e.length;i++)if(t.indexOf(e[i])>0){n=!1;break}return n},isCardID:function(t){if(!/(^\d{15}$)|(^\d{17}(\d|X|x)$)/.test(t))return alert("你输入的身份证长度或格式错误"),!1;if(!{11:"北京",12:"天津",13:"河北",14:"山西",15:"内蒙古",21:"辽宁",22:"吉林",23:"黑龙江",31:"上海",32:"江苏",33:"浙江",34:"安徽",35:"福建",36:"江西",37:"山东",41:"河南",42:"湖北",43:"湖南",44:"广东",45:"广西",46:"海南",50:"重庆",51:"四川",52:"贵州",53:"云南",54:"西藏",61:"陕西",62:"甘肃",63:"青海",64:"宁夏",65:"新疆",71:"台湾",81:"香港",82:"澳门",91:"国外"}[parseInt(t.substr(0,2))])return alert("你的身份证地区非法"),!1;var e=(t.substr(6,4)+"-"+Number(t.substr(10,2))+"-"+Number(t.substr(12,2))).replace(/-/g,"/"),n=new Date(e);if(e!=n.getFullYear()+"/"+(n.getMonth()+1)+"/"+n.getDate())return alert("身份证上的出生日期非法"),!1;for(var i=0,r=[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2],s=0;s<t.length-1;s++)i+=t[s]*r[s];var a="10X98765432"[i%11];return t[t.length-1]==a||(alert("你输入的身份证号非法"),!1)}};e.a=s},QsxK:function(t,e,n){"use strict";var i={debounce:function(t,e){var n=void 0;return function(){var i=this,r=arguments;clearTimeout(n),n=setTimeout(function(){t.apply(i,r)},e)}},throttle:function(t,e){var n=0;return function(){var i=new Date;i-n>e&&(t.apply(this,arguments),n=i)}},hit:function(t,e,n){var i=t.offsetTop,r=t.offsetTop+t.offsetHeight,s=t.offsetLeft,a=t.offsetLeft+t.offsetWidth,o=e.offsetTop,c=e.offsetTop+e.offsetHeight,u=e.offsetLeft,l=e.offsetLeft+e.offsetWidth;r>o&&a>u&&i<c&&s<l&&n()}};e.a=i},Xd32:function(t,e,n){n("+tPU"),n("zQR9"),t.exports=n("5PlU")},d7EF:function(t,e,n){"use strict";e.__esModule=!0;var i=s(n("us/S")),r=s(n("BO1k"));function s(t){return t&&t.__esModule?t:{default:t}}e.default=function(){return function(t,e){if(Array.isArray(t))return t;if((0,i.default)(Object(t)))return function(t,e){var n=[],i=!0,s=!1,a=void 0;try{for(var o,c=(0,r.default)(t);!(i=(o=c.next()).done)&&(n.push(o.value),!e||n.length!==e);i=!0);}catch(t){s=!0,a=t}finally{try{!i&&c.return&&c.return()}finally{if(s)throw a}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()},ndao:function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n("QsxK"),r={mounted:function(){var t=this;this.throttleLoad=i.a.throttle(function(){var e=document.documentElement.scrollTop||document.body.scrollTop,n=$(".masonry").height()||$(".comment-wrapper").height();console.log("scrollTop %o",e),console.log("containerHeight %o",n),e+200>n&&t.loadMore()},200),window.addEventListener("scroll",this.throttleLoad)},destroyed:function(){window.removeEventListener("scroll",this.throttleLoad)}}},"us/S":function(t,e,n){t.exports={default:n("Xd32"),__esModule:!0}}});