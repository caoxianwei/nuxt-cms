webpackJsonp([13],{"8D7h":function(e,t,s){"use strict";var r=s("woOf"),a=s.n(r),n=s("Xxa5"),i=s.n(n),o=s("exGp"),c=s.n(o),u=s("AmQK");t.a={layout:"login",data:function(){return{isWait:!0,form:{username:"",password:""},rules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]}}},mounted:function(){var e=c()(i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$store.dispatch("GT_REGISTER");case 2:t=e.sent,initGeetest({gt:t.gt,challenge:t.challenge,offline:!t.success,new_captcha:t.new_captcha,product:"popup",width:"300px"},this.validate);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),methods:{login:function(){var e=c()(i.a.mark(function e(){var t,s,r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=window.captchaObj.getValidate(),this.form.username&&this.form.password){e.next=5;break}return e.abrupt("return",this.$message.error("请输入用户名和密码"));case 5:if(t){e.next=7;break}return e.abrupt("return",this.$message.error("请完成验证"));case 7:return s={geetest_challenge:t.geetest_challenge,geetest_validate:t.geetest_validate,geetest_seccode:t.geetest_seccode},e.next=10,this.$store.dispatch("LOGIN",a()(this.form,s));case 10:(r=e.sent).success?(u.a.setCookie("token",r.data.token),this.$router.push("/"),this.$message({message:"登录成功",type:"success"}),setTimeout(function(){location.reload()},300)):(this.$message.error(r.message),window.captchaObj.reset());case 12:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),validate:function(){var e=c()(i.a.mark(function e(t){var s;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:s=this,t.appendTo("#captcha"),t.onReady(function(){s.isWait=!1}),window.captchaObj=t;case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}}},dUdm:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s("8D7h"),a=s("kdsp"),n=s("VU/8")(r.a,a.a,!1,null,null,null);n.options.__file="pages/sign-in.vue",t.default=n.exports},kdsp:function(e,t,s){"use strict";var r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"sign-page flex-center-c"},[s("div",{staticClass:"panel"},[e._m(0),s("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules}},[s("el-form-item",{attrs:{prop:"username"}},[s("el-input",{attrs:{placeholder:"用户名"},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1),s("el-form-item",{attrs:{prop:"password"}},[s("el-input",{attrs:{type:"password",placeholder:"密码"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.login(t):null}},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),s("div",{attrs:{id:"captcha"}},[s("p",{directives:[{name:"show",rawName:"v-show",value:e.isWait,expression:"isWait"}],staticClass:"waiting"},[e._v("正在加载验证码......")])]),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:e.login}},[e._v("登 录")])],1),s("div",{staticClass:"no-account"},[s("nuxt-link",{attrs:{to:"/sign-reset"}},[e._v("重置密码")]),e._v("没有账号？"),s("nuxt-link",{attrs:{to:"/sign-up"}},[e._v("点击注册")])],1)],1)],1)])};r._withStripped=!0;var a={render:r,staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"logo"},[t("span",[this._v("登 录")])])}]};t.a=a}});